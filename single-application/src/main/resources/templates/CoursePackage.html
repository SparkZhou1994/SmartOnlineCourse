<!DOCTYPE html>
<html lang="zh-cn" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
	<title></title>
	<meta charset="UTF-8">
	<link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
	<link rel="stylesheet" th:href="@{/css/bootstrap-theme.css}">
	<link rel="stylesheet" th:href="@{/css/index.css}">
	<link rel="icon" type="image/x-icon" th:href="@{/favicon.ico}">
	<script type="text/javascript" th:src="@{/js/jquery-3.3.1.min.js}"></script>
	<script type="text/javascript" th:src="@{/js/bootstrap.min.js}"></script>
	<script type="text/javascript">
        function loginOut(){
            //$(location).attr('href', 'index');
            //$(window).attr('location','index');
            $(location).prop('href', 'logout');
            $.session.clear();
        }
        function courseSearch() {
			var courseName=$("#search").val();
			if (courseName != "") {
                var url = "/SmartOnlineCourse/course_search/" + courseName;
                $.ajax({
                    url: url,  // 后台地址
                    type: "GET",
                    dataType: "json",
                    data: {},  //自己需要传递的数据 {}
                    success: function (data) {//成功
                        console.log(data);
                        $("#course_title").text("查询结果");
                        $(".course_list_content").remove();
                        $("#course_list").empty();
                        var obj = eval(data);
                        if (obj.error == 1) {
                            $messageNode = $("<h3></h3>")
                            $messageNode.text(data.message);
                            $("#course_list").append($messageNode);
                        } else {
                            var jsonMessage = obj.message;
                            for (var i = 0; i < jsonMessage.length; i++) {
                                $courseFramework = $("<div class='col-md-3'></div>");

                                $courseImage = $("<img>");
                                var imageSrc = jsonMessage[i].avatar;
                                if (imageSrc.search(/default/) >= 0) {
                                    var imageHref = imageSrc;
                                } else {
                                    var imageHref = "/SmartOnlineCourse" + imageSrc;
                                }
                                $courseImage.attr("src", imageHref);
                                $courseImage.attr("class", "img-responsive img-thumbnail");

                                $courseName = $("<h3></h3>");
                                $courseName.attr("class", "page-header");
                                $courseName.text(jsonMessage[i].courseName);

                                $courseOwner = $("<p></p>");
                                $courseOwner.text(jsonMessage[i].userName);

                                $courseFramework.append($courseImage, $courseName, $courseOwner);

                                $courseLink = $("<a></a>");
                                var courseId = jsonMessage[i].courseId;
                                var href = "/SmartOnlineCourse/join_course_deal_get/" + courseId.toString();
                                $courseLink.attr("href", href);
                                $courseLink.append($courseFramework);

                                $("#course_list").append($courseLink);
                            }
                        }
                    },
                    error: function () {//出错
                    }
                });
            }else{
                window.location.reload();
			}
        }
	</script>
	<meta name="viewprot"
		content="width=devive-width,initial-scale=1,user-scalable=no">
</head>
<body>
<div class="header">
	<div class="container">
		<div class="row">
			<div class="col-md-6 col-xs-6 col-sm-6">
				<a class="text-left" th:href="@{/my_index_return}">
					<img th:src="@{/image/logo.png}" height="50">
					<h4 style="display: inline;margin-left: 10px;">智能班课</h4>
				</a>
			</div>
			<div class="col-md-6 col-xs-6 col-sm-6">
				<div class="text-right">
					<ul class="list-unstyle list-inline" style="margin-top: 4px;" th:object="${session.user}">
						<li><a th:href="@{/course_package}"><span class="glyphicon glyphicon-folder-close"></span><h4 style="display: inline;margin-left: 5px;">课程包</h4></a></li>
						<li><a th:href="@{/my_index_return}"><span class="glyphicon glyphicon-list-alt"></span><h4 style="display: inline;margin-left: 5px;">我的课程</h4></a></li>
						<li><img th:src="@{${session.user.getAvatar()}}" style="width:34px;height:34px" class="img-responsive img-thumbnail"></li>
						<li><a th:href="@{/my_infor}"><h4 th:text="*{userName}"></h4></a></li>
						<li><a onclick="loginOut()"><h4>退出</h4></a></li>
					</ul>
				</div>
			</div>
		</div>
	</div>
</div>
	<div class="coursePackageMain">
		<div class="container">
			<div class="row" style="margin-top: 30px">
				<div class="col-sm-9 col-md-9 col-xs-9">
					<div class="input-group">
						<input type="search" name="search" id="search" class="form-control" placeholder="Search">
						<div class="input-group-addon"><a onclick="courseSearch()"><span class="glyphicon glyphicon-search"></span></a></div>
					</div>
				</div>
				<div class="col-md-3 col-xs-3 col-sm-3">
					<a href="" style="float: right;"><span class="glyphicon glyphicon-folder-close" style="color:#00BBDD"></span><h4 style="color: #00BBDD;display: inline;margin-left: 10px;" id="coursePackageLogo">课程包管理</h4></a>
				</div>
			</div>
			<img class="img-responsive" style="margin-top: 20px" th:src="@{/image/course_package_logo.jpg}" alt="course_package_logo">
			<h4 id="course_title" style="border-left: #00BBDD 4px solid;margin-top: 20px;padding-left: 20px">优选课程包</h4>
			<div id="course_list" class="row" style="margin-top: 40px;">
				<div class="col-md-3 course_list_content" th:each="course:${#httpServletRequest.getAttribute('courseList')}">
					<a th:href="@{'/join_course_deal_get/'+${course.getCourseId()}}">
						<img th:src="@{${course.getAvatar()}}" class="img-responsive img-thumbnail">
						<h3 class="page-header" th:text="${course.getCourseName()}">课程名</h3>
						<p th:text="${course.getUserName()}">任课老师</p>
						<span th:text="${course.getCourseId()}" style="display:none"></span>
					</a>
				</div>
			</div>
		</div>
	</div>
	<div id="footer">
		<h5 class="text-center">©2018 上海建桥学院</h5>
		<h5 class="text-center">地址：上海市浦东新区康桥路1500号    联系电话：13127945312    电子邮件：2637666515@qq.com </h5>
	</div>
</body>
</html>